Traceback (most recent call last):
  File "/home/john/anaconda3/envs/bcd/lib/python3.10/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/home/john/anaconda3/envs/bcd/lib/python3.10/site-packages/nbclient/client.py", line 1204, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/home/john/anaconda3/envs/bcd/lib/python3.10/site-packages/nbclient/util.py", line 84, in wrapped
    return just_run(coro(*args, **kwargs))
  File "/home/john/anaconda3/envs/bcd/lib/python3.10/site-packages/nbclient/util.py", line 62, in just_run
    return loop.run_until_complete(coro)
  File "/home/john/anaconda3/envs/bcd/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/john/anaconda3/envs/bcd/lib/python3.10/site-packages/nbclient/client.py", line 663, in async_execute
    await self.async_execute_cell(
  File "/home/john/anaconda3/envs/bcd/lib/python3.10/site-packages/nbclient/client.py", line 965, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/home/john/anaconda3/envs/bcd/lib/python3.10/site-packages/nbclient/client.py", line 862, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
_ = cases.summarize_morphology_by_feature(morphology='calc_type', by='assessment', figsize=(12,12))
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mKeyError[0m                                  Traceback (most recent call last)
Cell [0;32mIn[58], line 1[0m
[0;32m----> 1[0m _ [38;5;241m=[39m [43mcases[49m[38;5;241;43m.[39;49m[43msummarize_morphology_by_feature[49m[43m([49m[43mmorphology[49m[38;5;241;43m=[39;49m[38;5;124;43m'[39;49m[38;5;124;43mcalc_type[39;49m[38;5;124;43m'[39;49m[43m,[49m[43m [49m[43mby[49m[38;5;241;43m=[39;49m[38;5;124;43m'[39;49m[38;5;124;43massessment[39;49m[38;5;124;43m'[39;49m[43m,[49m[43m [49m[43mfigsize[49m[38;5;241;43m=[39;49m[43m([49m[38;5;241;43m12[39;49m[43m,[49m[38;5;241;43m12[39;49m[43m)[49m[43m)[49m

File [0;32m~/projects/bcd/bcd/analyze/explore/case.py:372[0m, in [0;36mCaseExplorer.summarize_morphology_by_feature[0;34m(self, morphology, by, figsize)[0m
[1;32m    369[0m     dfm_summary[morphology] [38;5;241m=[39m col[38;5;241m.[39mreplace(prefix, [38;5;124m"[39m[38;5;124m"[39m)
[1;32m    370[0m     summary [38;5;241m=[39m pd[38;5;241m.[39mconcat([summary, dfm_summary], axis[38;5;241m=[39m[38;5;241m0[39m)
[1;32m    371[0m summary [38;5;241m=[39m (
[0;32m--> 372[0m     [43msummary[49m[38;5;241;43m.[39;49m[43mgroupby[49m[43m([49m[43mby[49m[38;5;241;43m=[39;49m[43m[[49m[43mmorphology[49m[43m,[49m[43m [49m[43mby[49m[43m][49m[43m)[49m
[1;32m    373[0m     [38;5;241m.[39msum()
[1;32m    374[0m     [38;5;241m.[39msort_values(by[38;5;241m=[39m[morphology, [38;5;124m"[39m[38;5;124mproportion[39m[38;5;124m"[39m], ascending[38;5;241m=[39m[[38;5;28;01mTrue[39;00m, [38;5;28;01mFalse[39;00m])
[1;32m    375[0m )
[1;32m    376[0m [38;5;28mself[39m[38;5;241m.[39m_plot_morphology_by_feature(df[38;5;241m=[39msummary, morphology[38;5;241m=[39mmorphology, by[38;5;241m=[39mby, figsize[38;5;241m=[39mfigsize)
[1;32m    378[0m [38;5;28;01mreturn[39;00m summary

File [0;32m~/anaconda3/envs/bcd/lib/python3.10/site-packages/pandas/core/frame.py:8872[0m, in [0;36mDataFrame.groupby[0;34m(self, by, axis, level, as_index, sort, group_keys, observed, dropna)[0m
[1;32m   8869[0m [38;5;28;01mif[39;00m level [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m [38;5;129;01mand[39;00m by [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:
[1;32m   8870[0m     [38;5;28;01mraise[39;00m [38;5;167;01mTypeError[39;00m([38;5;124m"[39m[38;5;124mYou have to supply one of [39m[38;5;124m'[39m[38;5;124mby[39m[38;5;124m'[39m[38;5;124m and [39m[38;5;124m'[39m[38;5;124mlevel[39m[38;5;124m'[39m[38;5;124m"[39m)
[0;32m-> 8872[0m [38;5;28;01mreturn[39;00m [43mDataFrameGroupBy[49m[43m([49m
[1;32m   8873[0m [43m    [49m[43mobj[49m[38;5;241;43m=[39;49m[38;5;28;43mself[39;49m[43m,[49m
[1;32m   8874[0m [43m    [49m[43mkeys[49m[38;5;241;43m=[39;49m[43mby[49m[43m,[49m
[1;32m   8875[0m [43m    [49m[43maxis[49m[38;5;241;43m=[39;49m[43maxis[49m[43m,[49m
[1;32m   8876[0m [43m    [49m[43mlevel[49m[38;5;241;43m=[39;49m[43mlevel[49m[43m,[49m
[1;32m   8877[0m [43m    [49m[43mas_index[49m[38;5;241;43m=[39;49m[43mas_index[49m[43m,[49m
[1;32m   8878[0m [43m    [49m[43msort[49m[38;5;241;43m=[39;49m[43msort[49m[43m,[49m
[1;32m   8879[0m [43m    [49m[43mgroup_keys[49m[38;5;241;43m=[39;49m[43mgroup_keys[49m[43m,[49m
[1;32m   8880[0m [43m    [49m[43mobserved[49m[38;5;241;43m=[39;49m[43mobserved[49m[43m,[49m
[1;32m   8881[0m [43m    [49m[43mdropna[49m[38;5;241;43m=[39;49m[43mdropna[49m[43m,[49m
[1;32m   8882[0m [43m[49m[43m)[49m

File [0;32m~/anaconda3/envs/bcd/lib/python3.10/site-packages/pandas/core/groupby/groupby.py:1274[0m, in [0;36mGroupBy.__init__[0;34m(self, obj, keys, axis, level, grouper, exclusions, selection, as_index, sort, group_keys, observed, dropna)[0m
[1;32m   1271[0m [38;5;28mself[39m[38;5;241m.[39mdropna [38;5;241m=[39m dropna
[1;32m   1273[0m [38;5;28;01mif[39;00m grouper [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:
[0;32m-> 1274[0m     grouper, exclusions, obj [38;5;241m=[39m [43mget_grouper[49m[43m([49m
[1;32m   1275[0m [43m        [49m[43mobj[49m[43m,[49m
[1;32m   1276[0m [43m        [49m[43mkeys[49m[43m,[49m
[1;32m   1277[0m [43m        [49m[43maxis[49m[38;5;241;43m=[39;49m[43maxis[49m[43m,[49m
[1;32m   1278[0m [43m        [49m[43mlevel[49m[38;5;241;43m=[39;49m[43mlevel[49m[43m,[49m
[1;32m   1279[0m [43m        [49m[43msort[49m[38;5;241;43m=[39;49m[43msort[49m[43m,[49m
[1;32m   1280[0m [43m        [49m[43mobserved[49m[38;5;241;43m=[39;49m[38;5;28;43;01mFalse[39;49;00m[43m [49m[38;5;28;43;01mif[39;49;00m[43m [49m[43mobserved[49m[43m [49m[38;5;129;43;01mis[39;49;00m[43m [49m[43mlib[49m[38;5;241;43m.[39;49m[43mno_default[49m[43m [49m[38;5;28;43;01melse[39;49;00m[43m [49m[43mobserved[49m[43m,[49m
[1;32m   1281[0m [43m        [49m[43mdropna[49m[38;5;241;43m=[39;49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mdropna[49m[43m,[49m
[1;32m   1282[0m [43m    [49m[43m)[49m
[1;32m   1284[0m [38;5;28;01mif[39;00m observed [38;5;129;01mis[39;00m lib[38;5;241m.[39mno_default:
[1;32m   1285[0m     [38;5;28;01mif[39;00m [38;5;28many[39m(ping[38;5;241m.[39m_passed_categorical [38;5;28;01mfor[39;00m ping [38;5;129;01min[39;00m grouper[38;5;241m.[39mgroupings):

File [0;32m~/anaconda3/envs/bcd/lib/python3.10/site-packages/pandas/core/groupby/grouper.py:1009[0m, in [0;36mget_grouper[0;34m(obj, key, axis, level, sort, observed, validate, dropna)[0m
[1;32m   1007[0m         in_axis, level, gpr [38;5;241m=[39m [38;5;28;01mFalse[39;00m, gpr, [38;5;28;01mNone[39;00m
[1;32m   1008[0m     [38;5;28;01melse[39;00m:
[0;32m-> 1009[0m         [38;5;28;01mraise[39;00m [38;5;167;01mKeyError[39;00m(gpr)
[1;32m   1010[0m [38;5;28;01melif[39;00m [38;5;28misinstance[39m(gpr, Grouper) [38;5;129;01mand[39;00m gpr[38;5;241m.[39mkey [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:
[1;32m   1011[0m     [38;5;66;03m# Add key to exclusions[39;00m
[1;32m   1012[0m     exclusions[38;5;241m.[39madd(gpr[38;5;241m.[39mkey)

[0;31mKeyError[0m: 'calc_type'
KeyError: 'calc_type'

